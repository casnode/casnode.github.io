"use strict";(self.webpackChunkcasnode_website=self.webpackChunkcasnode_website||[]).push([[289],{3905:function(e,n,t){t.d(n,{Zo:function(){return c},kt:function(){return p}});var r=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var d=r.createContext({}),u=function(e){var n=r.useContext(d),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=u(e.components);return r.createElement(d.Provider,{value:n},e.children)},m={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},l=r.forwardRef((function(e,n){var t=e.components,i=e.mdxType,a=e.originalType,d=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),l=u(t),p=i,h=l["".concat(d,".").concat(p)]||l[p]||m[p]||a;return t?r.createElement(h,o(o({ref:n},c),{},{components:t})):r.createElement(h,o({ref:n},c))}));function p(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var a=t.length,o=new Array(a);o[0]=l;var s={};for(var d in n)hasOwnProperty.call(n,d)&&(s[d]=n[d]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var u=2;u<a;u++)o[u]=t[u];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}l.displayName="MDXCreateElement"},7583:function(e,n,t){t.r(n),t.d(n,{assets:function(){return d},contentTitle:function(){return o},default:function(){return m},frontMatter:function(){return a},metadata:function(){return s},toc:function(){return u}});var r=t(3117),i=(t(7294),t(3905));const a={title:"Migration von DiscuzX"},o=void 0,s={unversionedId:"migration",id:"migration",title:"Migration von DiscuzX",description:"Casnode hat eine Menge Go-Skripte zur Verf\xfcgung gestellt, um Benutzern zu helfen, ihre Foren von DiscuzX 3.x nach Casnode zu migrieren. Die Skripte befinden sich unter//github.com/casbin/casnode/tree/master/discuzx",source:"@site/i18n/de/docusaurus-plugin-content-docs/current/migration.md",sourceDirName:".",slug:"/migration",permalink:"/de/docs/migration",draft:!1,editUrl:"https://github.com/casnode/casnode-website/tree/master/docs/migration.md",tags:[],version:"current",frontMatter:{title:"Migration von DiscuzX"},sidebar:"tutorialSidebar",previous:{title:"docker",permalink:"/de/docs/docker"},next:{title:"API-\xdcbersicht",permalink:"/de/docs/api-overview"}},d={},u=[{value:"Zubereitung",id:"zubereitung",level:2},{value:"Konfiguration",id:"konfiguration",level:2},{value:"Migration",id:"migration",level:2}],c={toc:u};function m(e){let{components:n,...t}=e;return(0,i.kt)("wrapper",(0,r.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Casnode hat eine Menge Go-Skripte zur Verf\xfcgung gestellt, um Benutzern zu helfen, ihre Foren von DiscuzX 3.x nach Casnode zu migrieren. Die Skripte befinden sich unter: ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/casbin/casnode/tree/master/discuzx"},"https://github.com/casbin/casnode/tree/master/discuzx")),(0,i.kt)("p",null,"Eine Xorm-unterst\xfctzte Datenbank (z.B. MySQL) wird von Cansode verwendet, um Forendaten wie Themen und Antworten zu speichern. Die Objektspeicherung (als Form des Casdoor Speicheranbieters) wird von Casnode zur Speicherung von Bildern und Dateianh\xe4ngen verwendet."),(0,i.kt)("h2",{id:"zubereitung"},"Zubereitung"),(0,i.kt)("p",null,"Sie m\xfcssen die folgenden Umgebungen vorbereiten, bevor Sie die Migration durchf\xfchren:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Eine Cloud-VM (besser mit \xfcber 4 Kernen und 8 GB Speicher, 8 Kerne und 16 GB ist noch besser), besser bei Intranet-Verbindung mit der Datenbank f\xfcr h\xf6here Geschwindigkeit. Diese VM wird verwendet, um die Go-Migrationsskripte auszuf\xfchren."),(0,i.kt)("li",{parentName:"ol"},"Ein Casnode Git-Repository mit den Go-Migrationsskripten in der obigen VM (die Casnode-Instanz kann ausgef\xfchrt oder gestoppt werden)."),(0,i.kt)("li",{parentName:"ol"},"Eine laufende Casdoor Instanz (besser in der gleichen Cloud VM f\xfcr h\xf6here Geschwindigkeit), mit mindestens einem Objektspeicher als Speicheranbieter von Casdoor konfiguriert. Dies wird zum Hochladen der Bilder und Anh\xe4nge von DiscuzX in den Objektspeicher verwendet."),(0,i.kt)("li",{parentName:"ol"},"Ihre DiscuzX-Instanz ist online.")),(0,i.kt)("h2",{id:"konfiguration"},"Konfiguration"),(0,i.kt)("p",null,"Konfigurieren Sie zuerst die Casdoor und Casnode basierend auf den Installationsanleitungen, stellen Sie sicher, dass sie vor der Migration normal funktionieren."),(0,i.kt)("admonition",{title:"Lassen Sie Casdoor und Casnode sich mit der DB's Intranet URL verbinden. Lassen Sie Casdoor Endpunkt des Speicheranbieters die Intranet-URL des Cloud-Objekt-Speichers sein. Es wird viel schneller sein. :::",type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"Konfigurieren Sie die Casdoor Datenbank in Casnode's app.conf, damit Casnode sich direkt mit Casdoor's DB verbinden und Benutzer erstellen kann. Dies wird schneller sein, als Casdoor RESTful API aufzurufen, um Benutzer zu erstellen."),(0,i.kt)("pre",{parentName:"admonition"},(0,i.kt)("code",{parentName:"pre",className:"language-ini"},"casdoorDbName = casdoor\n")),(0,i.kt)("p",{parentName:"admonition"},"Konfigurieren Sie das Migrationsskript unter: ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/casbin/casnode/blob/master/discuzx/conf.go"},"https://github.com/casbin/casnode/blob/master/discuzx/conf.go")," ."),(0,i.kt)("ol",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ol"},"dbName: Ihr DiscuzX's DB-Name"),(0,i.kt)("li",{parentName:"ol"},"discuzxDomain: DiscuzX public Domain, mit folgendem Schr\xe4gstrich"),(0,i.kt)("li",{parentName:"ol"},"discuzxAttachmentBaseUrl: Die Anhang-Basis-URL Ihres DiscuzX mit folgendem Schr\xe4gstrich (Sie k\xf6nnen es von einer URL der Anhang-Datei Ihres DiscuzX erhalten)"),(0,i.kt)("li",{parentName:"ol"},"avatarPoolBaseUrl: \xc4ndern Sie dies nicht")),(0,i.kt)("pre",{parentName:"admonition"},(0,i.kt)("code",{parentName:"pre",className:"language-go"},'package discuzx\n\nvar dbName = "ultrax"\nvar discuzxDomain = "https://www.discuz.net/"\nvar discuzxAttachmentBaseUrl = "https://attachment.discuz.net/forum/"\n'))),(0,i.kt)("h2",{id:"migration"},"Migration"),(0,i.kt)("p",null,"Du kannst die ",(0,i.kt)("inlineCode",{parentName:"p"},"XXXConcurrency"),' oben an den Skripten sehen Dies ist die Anzahl der gleichzeitigen Threads, um die Migration durchzuf\xfchren. Sie k\xf6nnen diesen Wert auf Ihre Umgebung abstimmen. Wenn es zu klein ist, wird die Migration sehr langsam sein. Wenn es zu hoch ist, werden die DB-Verbindungen eher "Verbindungen zu viele" Fehler melden.'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},"var SyncAvatarsConcurrency = 20\n")),(0,i.kt)("admonition",{title:"Die Einsch\xe4tzungszeit, die wir in den folgenden Abschnitten gew\xe4hren, wird in einer Maschine mit einer entfernten Internetverbindung mit der DB und der Objektspeicherung gemessen. Wenn Ihr VM im selben Subnetz mit der DB und der Objektspeicherung ist, werden Sie viel schneller sein. :::",type:"tip"},(0,i.kt)("h3",{parentName:"admonition",id:"1-benutzermigration"},"1. Benutzermigration"),(0,i.kt)("p",{parentName:"admonition"},"Um alle Ihre DiscuzX's UCenter-Mitglieder zu Casdoor's Benutzern zu migrieren:"),(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},"TestAddUsers")," ausf\xfchren in: ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/casbin/casnode/blob/master/discuzx/user_test.go"},"https://github.com/casbin/casnode/blob/master/discuzx/user_test.go")),(0,i.kt)("p",{parentName:"admonition"},"Dieser Schritt dauert ungef\xe4hr 2 Minuten f\xfcr 60.000 Benutzer."),(0,i.kt)("h3",{parentName:"admonition",id:"2-benutzer-avatar-migration"},"2. Benutzer Avatar-Migration"),(0,i.kt)("p",{parentName:"admonition"},"Um alle Avatare Ihrer DiscuzX UCenter-Mitglieder zu Casdoor's Ressourcen zu migrieren (\xfcber Casdoor's Storage Provider, unterst\xfctzt durch den Cloud-Objekt-Speichern):"),(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},"TestSyncAvatars ausf\xfchren")," in: ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/casbin/casnode/blob/master/discuzx/avatar_test.go"},"https://github.com/casbin/casnode/blob/master/discuzx/avatar_test.go")),(0,i.kt)("p",{parentName:"admonition"},"Dieser Schritt dauert ungef\xe4hr 10 Minuten f\xfcr 60.000 Benutzer."),(0,i.kt)("h3",{parentName:"admonition",id:"3-forum-migration"},"3. Forum Migration"),(0,i.kt)("p",{parentName:"admonition"},"Um alle DiscuzX-Foren in die Tab und Knoten von Casdoor zu migrieren:"),(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},"TestAddForums")," in ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/casbin/casnode/blob/master/discuzx/forum_test.go"},"https://github.com/casbin/casnode/blob/master/discuzx/forum_test.go")," ausf\xfchren"),(0,i.kt)("p",{parentName:"admonition"},"Dieser Schritt endet in der Regel in 2 Sekunden."),(0,i.kt)("h3",{parentName:"admonition",id:"4-thread-und-post-migration"},"4. Thread und Post-Migration"),(0,i.kt)("p",{parentName:"admonition"},"To migrate all your DiscuzX's threads & posts to Casdoor's topics & replies:"),(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},"TestAddThreads")," ausf\xfchren in: ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/casbin/casnode/blob/master/discuzx/thread_test.go"},"https://github.com/casbin/casnode/blob/master/discuzx/thread_test.go")),(0,i.kt)("p",{parentName:"admonition"},"Dieser Schritt dauert ungef\xe4hr 7 Minuten f\xfcr 10.000 Benutzer."),(0,i.kt)("h2",{parentName:"admonition",id:"fertigstellung"},"Fertigstellung"),(0,i.kt)("p",{parentName:"admonition"},"W\xe4hrend der Migration k\xf6nnen Sie die Casnode-Instanz gleichzeitig laufen lassen damit Sie den Effekt sofort sehen k\xf6nnen, indem Sie ",(0,i.kt)("inlineCode",{parentName:"p"},"F5")," auf der \xf6ffentlichen Startseite von Casnode dr\xfccken."),(0,i.kt)("p",{parentName:"admonition"},"Wenn Sie beim Ausf\xfchren der Migrationsskripte auf Panik sto\xdfen, wenden Sie sich an die Autoren von Casnode.")))}m.isMDXComponent=!0}}]);