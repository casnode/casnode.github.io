(self.webpackChunkcasnode_website=self.webpackChunkcasnode_website||[]).push([[461],{9498:function(e,n,t){"use strict";t.r(n),t.d(n,{contentTitle:function(){return f},default:function(){return y},frontMatter:function(){return v},metadata:function(){return g},toc:function(){return b}});var a=t(2122),o=t(9756),r=t(7294),i=t(3905),l=t(944),s=t(6010),d="tabItem_1uMI",c="tabItemActive_2DSg";var u=37,p=39;var m=function(e){var n=e.lazy,t=e.block,a=e.defaultValue,o=e.values,i=e.groupId,m=e.className,h=(0,l.Z)(),k=h.tabGroupChoices,v=h.setTabGroupChoices,f=(0,r.useState)(a),g=f[0],b=f[1],N=r.Children.toArray(e.children),y=[];if(null!=i){var C=k[i];null!=C&&C!==g&&o.some((function(e){return e.value===C}))&&b(C)}var w=function(e){var n=e.currentTarget,t=y.indexOf(n),a=o[t].value;b(a),null!=i&&(v(i,a),setTimeout((function(){var e,t,a,o,r,i,l,s;(e=n.getBoundingClientRect(),t=e.top,a=e.left,o=e.bottom,r=e.right,i=window,l=i.innerHeight,s=i.innerWidth,t>=0&&r<=s&&o<=l&&a>=0)||(n.scrollIntoView({block:"center",behavior:"smooth"}),n.classList.add(c),setTimeout((function(){return n.classList.remove(c)}),2e3))}),150))},S=function(e){var n,t;switch(e.keyCode){case p:var a=y.indexOf(e.target)+1;t=y[a]||y[0];break;case u:var o=y.indexOf(e.target)-1;t=y[o]||y[y.length-1]}null==(n=t)||n.focus()};return r.createElement("div",{className:"tabs-container"},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":t},m)},o.map((function(e){var n=e.value,t=e.label;return r.createElement("li",{role:"tab",tabIndex:g===n?0:-1,"aria-selected":g===n,className:(0,s.Z)("tabs__item",d,{"tabs__item--active":g===n}),key:n,ref:function(e){return y.push(e)},onKeyDown:S,onFocus:w,onClick:w},t)}))),n?(0,r.cloneElement)(N.filter((function(e){return e.props.value===g}))[0],{className:"margin-vert--md"}):r.createElement("div",{className:"margin-vert--md"},N.map((function(e,n){return(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==g})}))))};var h=function(e){var n=e.children,t=e.hidden,a=e.className;return r.createElement("div",{role:"tabpanel",hidden:t,className:a},n)},k=["components"],v={title:"Installation",slug:"/installation"},f=void 0,g={unversionedId:"installation",id:"installation",isDocsHomePage:!1,title:"Installation",description:"These paragraphs will help you deploy Casnode on your server. If you want to install Casnode by BT panel or Docker, please look BT panel and Docker.",source:"@site/i18n/zh/docusaurus-plugin-content-docs/current/installation.mdx",sourceDirName:".",slug:"/installation",permalink:"/zh/docs/installation",editUrl:"https://github.com/casnode/casnode-website/tree/master/docs/installation.mdx",version:"current",frontMatter:{title:"Installation",slug:"/installation"},sidebar:"tutorialSidebar",previous:{title:"Main Features",permalink:"/zh/docs/main-features"},next:{title:"BTpanel",permalink:"/zh/docs/BTpanel"}},b=[{value:"Production Environment",id:"production-environment",children:[{value:"1. Setup Casdoor",id:"1-setup-casdoor",children:[]},{value:"2. Modify <code>conf/app.conf</code>",id:"2-modify-confappconf",children:[]},{value:"3. Modify <code>web/src/Conf.js</code>",id:"3-modify-websrcconfjs",children:[]},{value:"4. Build front end",id:"4-build-front-end",children:[]},{value:"5. Build back end",id:"5-build-back-end",children:[]}]},{value:"Dev Environment",id:"dev-environment",children:[{value:"1. Do step 1-3 above",id:"1-do-step-1-3-above",children:[]},{value:"4. Run back end",id:"4-run-back-end",children:[]},{value:"5. Run front end",id:"5-run-front-end",children:[]}]}],N={toc:b};function y(e){var n=e.components,t=(0,o.Z)(e,k);return(0,i.kt)("wrapper",(0,a.Z)({},N,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"These paragraphs will help you deploy Casnode on your server. If you want to install Casnode by BT panel or Docker, please look ",(0,i.kt)("a",{parentName:"p",href:"/zh/docs/BTpanel"},"BT panel")," and ",(0,i.kt)("a",{parentName:"p",href:"/zh/docs/Docker"},"Docker"),"."),(0,i.kt)("p",null,"Please clone Casnode first:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/casbin/casnode\n")),(0,i.kt)("p",null,"and follow these steps to easily setup your own forum!"),(0,i.kt)("h2",{id:"production-environment"},"Production Environment"),(0,i.kt)("h3",{id:"1-setup-casdoor"},"1. Setup Casdoor"),(0,i.kt)("p",null,"Casnode uses ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/casbin/casdoor"},"Casdoor")," to manage members. So you need to create an organization and an application for Casnode in a Casdoor instance."),(0,i.kt)("p",null,"Follow these steps to setup Casdoor for Casnode:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Navigate to Casdoor (Click ",(0,i.kt)("a",{parentName:"li",href:"https://casdoor.org/docs/overview"},"here")," for details of Casdoor)"),(0,i.kt)("li",{parentName:"ul"},'Sign into the organization "built-in"'),(0,i.kt)("li",{parentName:"ul"},"Click ",(0,i.kt)("strong",{parentName:"li"},"Organizations")," in the top bar"),(0,i.kt)("li",{parentName:"ul"},"Click ",(0,i.kt)("strong",{parentName:"li"},"add")," button"),(0,i.kt)("li",{parentName:"ul"},"Remember the Organization name (Of course you can change the organization name first)"),(0,i.kt)("li",{parentName:"ul"},"Click ",(0,i.kt)("strong",{parentName:"li"},"Applications")," in the top bar"),(0,i.kt)("li",{parentName:"ul"},"Click ",(0,i.kt)("strong",{parentName:"li"},"add")," button"),(0,i.kt)("li",{parentName:"ul"},"Remember the Application name (Of course you can change the Application name first)"),(0,i.kt)("li",{parentName:"ul"},"Click ",(0,i.kt)("strong",{parentName:"li"},"Edit")),(0,i.kt)("li",{parentName:"ul"},"Select the organization you just created as the application organization"),(0,i.kt)("li",{parentName:"ul"},"Modify the redirect URLs to the forum URL. If you are in a developing environment, your redirect URL is http://localhost:3000/callback. If you are in a production environment, your redirect URL is http://yourip:7000/callback"),(0,i.kt)("li",{parentName:"ul"},"Click ",(0,i.kt)("strong",{parentName:"li"},"Save")," and remember the ",(0,i.kt)("inlineCode",{parentName:"li"},"Client ID")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"Client Secret"))),(0,i.kt)("h3",{id:"2-modify-confappconf"},"2. Modify ",(0,i.kt)("inlineCode",{parentName:"h3"},"conf/app.conf")),(0,i.kt)("p",null,"Here is an explanation of the config items:"),(0,i.kt)("p",null,"Database connection:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ini"},"driverName = mysql\ndataSourceName = root:123@tcp(localhost:3306)/\ndbName = casnode\n")),(0,i.kt)("p",null,"Object Storage Service (Casnode uses OSS to store resources):"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ini"},'OSSProvider = ""\naccessKeyID     = ""\naccessKeySecret = ""\nOSSCustomDomain = ""\nOSSBasicPath = ""\nOSSRegion = ""\nOSSEndPoint = ""\nOSSBucket = ""\n')),(0,i.kt)("p",null,"If you can not access Google in normal ways, you need to set up a http proxy here:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ini"},'httpProxy = "127.0.0.1:10808"\n')),(0,i.kt)("p",null,"Casdoor config:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ini"},'# Your Casdoor endpoint in step 1\ncasdoorEndpoint = http://localhost:8000\n\n# Client ID you copied in step 1\nclientId = xxx\n\n# Client Secret you copied in step 1\nclientSecret = xxx\n\njwtSecret = CasdoorSecret\n\n# Organization name in step 1\ncasdoorOrganization = "casbin-forum"\n')),(0,i.kt)("h3",{id:"3-modify-websrcconfjs"},"3. Modify ",(0,i.kt)("inlineCode",{parentName:"h3"},"web/src/Conf.js")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'export const AuthConfig = {\n  // Your Casdoor endpoint in step 1\n  serverUrl: "http://localhost:7001",\n\n  // Client ID you copied in step 1\n  clientId: "014ae4bd048734ca2dea",\n\n  // Application name you copied in step 1\n  appName: "app-casbin-forum",\n\n  // Organization name you copied in step 1\n  organizationName: "casbin-forum",\n};\n')),(0,i.kt)("h3",{id:"4-build-front-end"},"4. Build front end"),(0,i.kt)("p",null,"In folder ",(0,i.kt)("inlineCode",{parentName:"p"},"web"),", run the following commands:"),(0,i.kt)(m,{defaultValue:"yarn",values:[{label:"Yarn",value:"yarn"},{label:"npm",value:"npm"}],mdxType:"Tabs"},(0,i.kt)(h,{value:"yarn",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"yarn install && yarn run build\n"))),(0,i.kt)(h,{value:"npm",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"npm install && npm run build\n")))),(0,i.kt)("h3",{id:"5-build-back-end"},"5. Build back end"),(0,i.kt)("p",null,"In repository root, run:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"go build\n./casnode\n")),(0,i.kt)("p",null,"Then the Casnode app should run on port 7000. You can setup a nginx proxy pass to manage SSL or something else."),(0,i.kt)("p",null,"For most of site owners who want to develop a forum using Casnode, steps above is enough. But if you are a developer, want to contribute to Casnode, or modify the code to suit your own environment, then you can run Casnode in the developing mode. Please follow these steps to start developing mode:"),(0,i.kt)("h2",{id:"dev-environment"},"Dev Environment"),(0,i.kt)("h3",{id:"1-do-step-1-3-above"},"1. Do step 1-3 above"),(0,i.kt)("h3",{id:"4-run-back-end"},"4. Run back end"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},"go run main.go\n")),(0,i.kt)("h3",{id:"5-run-front-end"},"5. Run front end"),(0,i.kt)("p",null,"In ",(0,i.kt)("inlineCode",{parentName:"p"},"web")," folder:"),(0,i.kt)(m,{defaultValue:"yarn",values:[{label:"Yarn",value:"yarn"},{label:"npm",value:"npm"}],mdxType:"Tabs"},(0,i.kt)(h,{value:"yarn",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"yarn install\nyarn run start\n"))),(0,i.kt)(h,{value:"npm",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"npm install\nnpm run start\n")))),(0,i.kt)("p",null,"Now, Casnode runs its front end at port 3000 and runs it's back end at port 7000. You can modify the code and see what will happen."),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"The front end uses these codes to determine whether it is a dev mode:")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},'export function initServerUrl() {\n  const hostname = window.location.hostname;\n  if (hostname === "localhost") {\n    ServerUrl = `http://${hostname}:7000`;\n  }\n}\n')),(0,i.kt)("p",{parentName:"div"},"It means if hostname is ",(0,i.kt)("inlineCode",{parentName:"p"},"localhost"),", then you are in dev mode. If not, then you are in productive mode. Port of the back end is not same in dev mode and productive mode, so please do not use ",(0,i.kt)("inlineCode",{parentName:"p"},"127.0.0.1")," instead of ",(0,i.kt)("inlineCode",{parentName:"p"},"localhost")," in your browser in dev mode. :::"))))}y.isMDXComponent=!0}}]);